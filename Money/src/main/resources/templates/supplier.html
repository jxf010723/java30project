<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/supplier.css">
    <link rel="stylesheet" href="css/bootstrap.css">
   <script src="js/distpicker.data.js"></script>
	  <script src="js/distpicker.js"></script>
	  <script src="js/main.js"></script>
    
</head>
<body>

<div class="rightarea clearfix" >
    <div class="mainarea clearfix" id="suppvue">
        <div class="mainhead">
            <span class="title">供应商</span>
            <div class="searchArea">
                <div class="btn-div">
                    <a href="" class="btn btn-success" data-toggle="modal" data-target="#supplierModal">
                        添加供应商
                    </a>
                </div>
            </div>

            <div class="list search">
                <input class="inputtext" type="text" placeholder="查找" id="ming">
                <a href="javascript:void(0)" class="search-btn" @click="mingpage"></a>
            </div>
            <div class="list">
            <form class="form-inline">
      <div data-toggle="distpicker">
        <div class="form-group">
          <label class="sr-only" for="province7">Province</label>
          <select class="form-control" id="province7" @change="shengpage()"></select>
        </div>
        <div class="form-group">
          <label class="sr-only" for="city7">City</label>
          <select class="form-control" id="city7"></select>
        </div>
      </div>
    </form>
             
        </div>
         <div class="list">
                <span style="position: relative;top: 10px;">地&nbsp;&nbsp;&nbsp;&nbsp;区</span>
            </div>
        <div class="mainbody">
            <table class="settable table table-striped">
                <thead>
                <tr>
                    <th width="5%">序号</th>
                    <th width="12%">简称</th>
                    <th width="16%">公司名称</th>
                    <th width="8%">联系人</th>
                    <th width="11%">手机</th>
                    <th width="11%">电话</th>
                    <th width="15%">邮箱</th>
                    <th width="14%">地区</th>
                    <th width="8%">操作</th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="item,index in page.list">
                    <td>
                      {{index+1}}
                    </td>
                    <td>{{item.cohr}}
                    </td>
                    <td>{{item.suppliername}}
                    </td>
                    <td >{{item.contact}}
                    </td>
                    <td>{{item.phone}}</td>
                    <td>{{item.telephone}}</td>
                    <td>{{item.email}}</td>
                    <td>-</td>
                    <td>
                        <a href="javascript:;" @click="del(item.supplierid)">删除</a>
                        <a href="javascript:;" @click="upd(item)">编辑</a>
                    </td>
                </tr>
                </tbody>
                
            </table>
             <tr>
									<td colspan="5">
										<ul class="pager">
											<li>
												<a href="javascript:void(0)" @click="shou">首页</a>
											</li>
											<li class="abled" >
												<a href="javascript:void(0)" @click="shang">上一页</a>
											</li>
											<li class="abled"  >
												<a href="javascript:void(0)" @click="xia">下一页</a>
											</li>
											<li>
												<a href="javascript:void(0)" @click="wei">末页</a>
											</li>
											<li class="disabled">
												<a href="javascript:void(0)" style="margin-left: 50px;">第<b id="num">{{page.pageNum}}</b>页/ 共<b id="pages">{{page.pages}}</b>页  &nbsp; &nbsp;  共<b id="size">{{page.total}}</b>条记录</a>
											</li>
										</ul>
									</td>
				</tr>
                
				
        </div>
    </div>
    <!-- 模态框（Modal） -->
		<div class="modal fade" id="supplierModal" tabindex="-1" role="dialog" aria-labelledby="supplierModalLabel" aria-hidden="true">
		    <div style="width: 76.66%;"  class="modal-dialog">
		        <div class="modal-content">
		            <div class="modal-header">
		                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		                <h4 class="modal-title" id="supplierModalLabel">添加供应商</h4>
		            </div>
		            <div class="modal-body" style="padding:50px">
		            	<form class="form-horizontal">
						  <div class="form-group">
						    <label for="inputEmail3" class="col-sm-2 control-label">公司名称</label>
						    <div class="col-sm-4">
						      <input type="text" class="form-control" id="suppname" v-model="supplier.suppliername">
						    </div>
						    
						     <label for="inputEmail3" class="col-sm-2 control-label"><i style="position: relative;top:4px;right:5px;color: red;">*</i>公司简称</label>
						    <div class="col-sm-4">
						      <input type="text" class="form-control" id="cohr" v-model="supplier.cohr">
						    </div>
						  </div>
						  
						  <div class="form-group">
						    <label for="inputEmail3" class="col-sm-2 control-label">联&nbsp;&nbsp;系  人</label>
						    <div class="col-sm-4">
						      <input type="text" class="form-control" id="contact" v-model="supplier.contact">
						    </div>
						    
						     <label for="inputEmail3" class="col-sm-2 control-label"><i style="position: relative;top:4px;right:5px;color: red;">*</i>手&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;机</label>
						    <div class="col-sm-4">
						      <input type="text" class="form-control" id="phone" v-model="supplier.phone">
						    </div>
						  </div>
						  
						  <div class="form-group">
						    <label for="inputEmail3" class="col-sm-2 control-label">邮&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;箱</label>
						    <div class="col-sm-4">
						      <input type="text" class="form-control" id="email" v-model="supplier.email">
						    </div>
						    
						     <label for="inputEmail3" class="col-sm-2 control-label">电&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;话</label>
						    <div class="col-sm-4">
						      <input type="text" class="form-control" id="telephone" v-model="supplier.telephone">
						    </div>
						  </div>
						  
						   <div class="form-group">
						    <label for="inputEmail3" class="col-sm-2 control-label">地&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;址</label>
						    <div class="col-sm-10">
						         <input type="text" class="form-control" id="province" name="province" style="width: 25%;display: inline-block;" placeholder="所在省" v-model="supplier.province">
                         	  &nbsp; <input class="form-control" type="text" id="city" name="city" style="width: 25%;display: inline-block;" placeholder="所在省"  v-model="supplier.city">  
                           	 &nbsp;<input  type="text" class="form-control" id="district" name="district" style="width: 25%;display: inline-block;" placeholder="所在区"  v-model="supplier.district">
                            
                           
						    
						    </div>
						  </div>
						  <div class="form-group">
						    <label for="inputEmail3" class="col-sm-2 control-label">街&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;道</label>
						    <div class="col-sm-8">
						      <input type="text" class="form-control" id="street" v-model="supplier.street">
						    </div>
						  </div>
						</form>
		            </div>
		            <div class="modal-footer" style="text-align: center;">
		                <button type="button" class="btn btn-default" data-dismiss="modal" style="width: 16.66%;">取消</button>
		                <button type="button" class="btn btn-success" style="width: 16.66%;" @click="supplierinsert">确认</button>
		            </div>
		        </div><!-- /.modal-content -->
		    </div><!-- /.modal -->
		</div>
</div>

	</div>
	
	
	
		
</body>
</html>

<script type="text/javascript">
//我来判断是新增还是修改
var bool=0;
/*模态框*/
$('#exampleModal').on('show.bs.modal', function (event) {
	  var button = $(event.relatedTarget) // Button that triggered the modal
	  var recipient = button.data('whatever') // Extract info from data-* attributes
	  // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
	  // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
	  var modal = $(this)
	  modal.find('.modal-title').text(recipient)
	  modal.find('.modal-body input').val(recipient)
 })  
 

	var supplier=new Vue({
		el:"#suppvue",
		data(){
			return{
				page:{
					list:[]
				},
				supplier:{
					
				}
				
			}
		},
		methods:{
			upd:function(item){//修改
				 //alert(1)
				 $('#supplierModal').modal('show');
					  var button = $(event.relatedTarget) // 触发模式的按钮
					  var recipient = button.data('whatever') // 从数据中提取信息-*属性
					  // 如果需要，可以在这里启动AJAX请求（然后在回调中进行更新）。
					  // 更新模态的内容。我们将在这里使用jQuery，但是您可以使用数据绑定库或其他方法。
					  $('#supplierModalLabel').html("供应商编辑")
					  $('#exampleModal').find('.modal-body input').val(item.suppliername)
					 $("#suppname").val(item.suppliername);
					  $("#cohr").val(item.cohr);
					  $("#contact").val(item.contact);
					  $("#phone").val(item.phone);
					  $("#email").val(item.email);
					  $("#telephone").val(item.telephone);
					  $("#province").val(item.province);
					  $("#city").val(item.city);
					  $("#district").val(item.district);
					  $("#street").val(item.street);
					  bool=item.supplierid;
			 },
			 del:function(supid){
				 if (confirm("您确认要删除改供应商吗？")) {
				 $.ajax({
						data:{id:supid},
						url:"[[@{goods/supplierdelete}]]",
						type:"post",
						success:function(res){
						}
					});
				 this.pages(1,null,null,null);
				 }
			 },
			pages:function(dqy,sheng,shi,ming){
				var th=this;
				$.ajax({
					data:{pageNum:dqy,sheng:sheng,shi:shi,ming:ming},
					url:"[[@{goods/goodssupplierpage}]]",
					type:"post",
					success:function(res){
						console.log(res);
						th.page=res;						
					}
				});
			},
			shengpage:function(){
				var sheng= $("#province7").val();
				
				this.pages(1,sheng,null,null);
			},
			mingpage:function(){
				var sheng= $("#province7").val();
				alert(sheng);
				var ming=$("#ming").val()
				this.pages(1,sheng,null,ming);
			},
			xia:function(){
				if(this.page.hasNextPage) {
					this.pages(this.page.nextPage,null,null,null);
				}
				
			},
			shang:function(){
				if(this.page.hasPreviousPage) {
					this.pages(this.page.prePage,null,null,null);
				}
			},
			wei: function() {
				this.pages(this.page.pages,null,null,null);
			},
			shou: function() {
				this.pages(1,null,null,null);
			},
			supplierinsert:function(){
				
				if(bool==0){
					$.ajax({
						url:"[[@{goods/supplierinsert}]]",
						data:JSON.stringify(this.supplier),
						contentType : "application/json;charset=utf-8",
						type:"post",
						dataType:"json",
						success:function(res){
						}
					});
					$("#supplierModal").modal('hide');  
				}else{
					this.supplier.supplierid=bool;
					$.ajax({
						url:"[[@{goods/supplierupdate}]]",
						data:JSON.stringify(this.supplier),
						contentType : "application/json;charset=utf-8",
						type:"post",
						dataType:"json",
						success:function(res){
						}
					});
					$("#supplierModal").modal('hide');  
				}
				this.pages(1,null,null,null);
			}
		},
		mounted:function(){
			this.pages(1,null,null,null);
		}
		
	});
</script>